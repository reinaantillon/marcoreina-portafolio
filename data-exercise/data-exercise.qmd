---
title: "Data Exercise"
---

### Disclaimer: used ChatGPT to generate code for synthetic data

```{r}
library(tidyverse)
library(skimr)
```

```{r}
set.seed(123)

n <- 500

synthetic_data <- tibble(
  age = rnorm(n, mean = 35, sd = 10),
  exposure = rbinom(n, size = 1, prob = 0.4),
  dose = runif(n, 0, 10)
) %>%
  mutate(
    # Linear outcome with known effects
    outcome_continuous =
      5 +
      0.4 * age +        # age effect
      2.5 * exposure +  # exposure effect
      1.2 * dose +      # dose effect
      rnorm(n, 0, 5),

    # Logistic outcome (binary)
    outcome_binary =
      rbinom(
        n,
        size = 1,
        prob = plogis(
          -6 +
          0.05 * age +
          1.3 * exposure +
          0.25 * dose
        )
      )
  )

```

```{r}
skim(synthetic_data)
```

```{r}
synthetic_data <- synthetic_data %>%
  mutate(
    age_group = cut(
      age,
      breaks = seq(15, 75, by = 10),
      include.lowest = TRUE
    )
  )

age_outcome_summary <- synthetic_data %>%
  group_by(age_group) %>%
  summarize(
    proportion_positive = mean(outcome_binary),
    n = n(),
    .groups = "drop"
  )
```

```{r}
plot1 <- ggplot(synthetic_data, aes(x = dose, y = outcome_continuous, color = age_group)) +
  geom_point(alpha = 0.4) +
  theme_bw()

plot1
```

```{r}
plot2 <- synthetic_data %>%
  filter(outcome_binary == 1) %>%
  ggplot(aes(x = age_group)) +
  geom_bar() +
  labs(
    x = "Age group",
    y = "Count of positive outcomes",
    title = "Count of binary outcomes by age group"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot2
```

```{r}
lm_fit <- lm(
  outcome_continuous ~ age + exposure + dose,
  data = synthetic_data
)

summary(lm_fit)

```


